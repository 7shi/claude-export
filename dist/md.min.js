!async function(){const e=document.querySelector("div.flex-1.flex.flex-col.gap-3.px-4"),t=document.querySelector("button[data-testid='chat-menu-trigger']")?.textContent||"";function n(e){return"DIV"===e.tagName&&e.hasAttribute("data-test-render-count")}function o(e,t){const n=Array.from(e.getElementsByTagName("button")).filter((e=>e.innerText==t));return n.length?n[0]:null}let i=0;for(const t of e.childNodes)if(n(t)){const e=t.querySelector("div.font-user-message");if(e){const t=e.parentElement.nextElementSibling;if(t){const e=o(t,"Edit");e&&(e.click(),i++)}}}for(let t=0;t<30;t++){await new Promise((e=>setTimeout(e,100)));if(e.getElementsByTagName("form").length==i)break}let a=`# ${t||"Claude Chat"}\n\`${new Date(new Date(new Date(new Date).toISOString()).getTime()-6e4*(new Date).getTimezoneOffset()).toISOString().slice(0,19).replace("T"," ")}\`\n`;function c(e,t){let n=e;if("DIV"===n.firstChild?.tagName&&(n=n.firstChild,"DIV"===n.firstChild?.tagName&&(n=n.firstChild)),n.firstChild){a+=t;for(const e of n.childNodes)a+=l(e)}}function r(e){return e=e.replace(/(?<!^)\$\$(.*?)\$\$(?!$)/gm,"$$$1$$")}for(const t of e.childNodes){let e="\n## Prompt:\n\n";if("FORM"===t.tagName){const n=t.querySelector("textarea");n&&(a+=e+r(n.value).trimEnd()+"\n\n");continue}if(!n(t))continue;const i=t.querySelector("div.font-user-message");if(i){c(i,e);continue}e="_Claude_:\n";const l=t.querySelector("div.font-claude-message");if(l){const t=o(l.nextSibling,"Copy");if(!t){c(l,e);continue}a+=e;const n=navigator.clipboard;n._writeText||(n._writeText=n.writeText),await new Promise(((e,o)=>{n.writeText=async t=>{a+=r(t).trimEnd()+"\n",e()};try{t.click()}catch(e){o(e)}})),n.writeText=n._writeText}}function l(e){if(e.nodeType!==Node.ELEMENT_NODE)return"";const t=e.tagName,n=e.textContent;let o="";if("P"===t&&(o+=`${n}\n`),"OL"===t){let t=0;e.childNodes.forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&"LI"===e.tagName&&(o+=`${++t}. ${e.textContent}\n`)}))}if("UL"===t&&e.childNodes.forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&"LI"===e.tagName&&(o+=`- ${e.textContent}\n`)})),"PRE"===t){const e=n.split("Copy code"),t=e[0].trim(),i=e[1].trim();o+=`\`\`\`${t}\n${i}\n\`\`\`\n`}if("DIV"===t){const t=e.querySelector("div.code-block__code");if(!t)return"";const n=t.innerText.trim();o+=`\`\`\`\n${n}\n\`\`\`\n`}if("BLOCKQUOTE"===t)for(const e of n.trim().split("\n"))o+=`> ${e}\n`;if("TABLE"===t){let t="";e.childNodes.forEach((e=>{if(e.nodeType===Node.ELEMENT_NODE&&("THEAD"===e.tagName||"TBODY"===e.tagName)){let n="",o=0;if(e.childNodes.forEach((t=>{if(t.nodeType===Node.ELEMENT_NODE&&"TR"===t.tagName){let i="";t.childNodes.forEach((t=>{t.nodeType!==Node.ELEMENT_NODE||"TD"!==t.tagName&&"TH"!==t.tagName||(i+=`| ${t.textContent} `,"THEAD"===e.tagName&&o++)})),n+=`${i}|\n`}})),t+=n,"THEAD"===e.tagName){const e=`| ${Array(o).fill("---").join(" | ")} |\n`;t+=e}}})),o+=t}return o+"\n"}e.dispatchEvent(new KeyboardEvent("keydown",{key:"Escape",code:"Escape",keyCode:27,which:27,bubbles:!0,cancelable:!0})),function(e,t,n,o){let i=n?n.trim().toLowerCase().replace(/^[^\w\d]+|[^\w\d]+$/g,"").replace(/[\s\W-]+/g,"-"):"claude";i+=e;const a=new Blob([o],{type:t}),c=document.createElement("a");c.download=i,c.href=window.URL.createObjectURL(a),c.dataset.downloadurl=[t,c.download,c.href].join(":");const r=new MouseEvent("click",{canBubble:!0,cancelable:!1,view:window,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null});c.dispatchEvent(r)}(".md","text/plain",t,a)}();